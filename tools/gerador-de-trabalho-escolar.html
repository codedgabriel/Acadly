<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Trabalhos Escolares | Acadly</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&family=Times+New+Roman&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #1e88e5;
            --primary-dark: #1565c0;
            --primary-light: #90caf9;
            --secondary-color: #263238;
            --background-dark: #121212;
            --background-light: #1e1e1e;
            --background-lighter: #2a2a2a;
            --text-primary: #f5f5f5;
            --text-secondary: #b0b0b0;
            --border-color: #444;
            --success-color: #4caf50;
            --danger-color: #f44336;
            --warning-color: #ff9800;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Poppins', sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: var(--background-dark);
            color: var(--text-primary);
            line-height: 1.6;
        }

        h1,
        h2,
        h3 {
            font-weight: 600;
            color: var(--primary-color);
        }

        h1 {
            text-align: center;
            margin: 20px 0 30px;
            font-size: 2rem;
            background: linear-gradient(90deg, var(--primary-color), var(--primary-light));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .logo {
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.2rem;
            font-weight: bold;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .logo svg {
            width: 30px;
            height: 30px;
        }

        .form-container {
            background: var(--background-light);
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
            margin-bottom: 30px;
            border: 1px solid var(--border-color);
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 500;
            color: var(--text-primary);
            font-size: 0.95rem;
        }

        .input-hint {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 5px;
            font-style: italic;
        }

        input[type="text"],
        textarea,
        select {
            width: 100%;
            padding: 14px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            box-sizing: border-box;
            font-family: 'Times New Roman', Times, serif;
            background-color: var(--secondary-color);
            color: var(--text-primary);
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        input[type="text"]:focus,
        textarea:focus,
        select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(30, 136, 229, 0.2);
        }

        textarea {
            min-height: 120px;
            resize: vertical;
            line-height: 1.6;
        }

        .button-group {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            margin-top: 25px;
        }

        button {
            padding: 14px 26px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(30, 136, 229, 0.3);
        }

        .btn-secondary {
            background-color: var(--secondary-color);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background-color: var(--background-lighter);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .btn-danger {
            background-color: var(--danger-color);
            color: white;
        }

        .btn-danger:hover {
            background-color: #d32f2f;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(244, 67, 54, 0.3);
        }

        .btn-warning {
            background-color: var(--warning-color);
            color: white;
        }

        .btn-warning:hover {
            background-color: #e68a00;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 152, 0, 0.3);
        }

        .section {
            background: var(--background-lighter);
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 25px;
            border-left: 5px solid var(--primary-color);
            position: relative;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .section:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }

        .section-title {
            margin: 0 0 15px 0;
            color: var(--primary-color);
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title svg {
            width: 20px;
            height: 20px;
        }

        .remove-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            padding: 8px 12px;
            font-size: 0.8rem;
        }

        .image-preview {
            max-width: 100%;
            max-height: 250px;
            margin: 15px 0;
            border-radius: 6px;
            display: none;
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        .author-container {
            margin-bottom: 20px;
        }

        .authors-list {
            margin-top: 15px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .author-item {
            display: inline-flex;
            align-items: center;
            padding: 8px 15px;
            background-color: rgba(30, 136, 229, 0.1);
            border-radius: 20px;
            border: 1px solid rgba(30, 136, 229, 0.3);
            font-size: 0.9rem;
        }

        .remove-author {
            background-color: transparent;
            color: var(--danger-color);
            border: none;
            border-radius: 50%;
            padding: 2px;
            cursor: pointer;
            margin-left: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .remove-author svg {
            width: 16px;
            height: 16px;
        }

        .footer {
            text-align: center;
            margin-top: 50px;
            color: var(--text-secondary);
            font-size: 0.9rem;
            padding: 20px 0;
            border-top: 1px solid var(--border-color);
        }

        .footer a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 500;
        }

        .footer a:hover {
            text-decoration: underline;
        }

        .section-content {
            margin-top: 20px;
        }

        .content-option {
            margin-bottom: 20px;
            padding: 15px;
            background-color: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            border: 1px dashed var(--border-color);
        }

        .content-option label {
            display: flex;
            align-items: center;
            cursor: pointer;
            margin-bottom: 10px;
            font-size: 0.95rem;
        }

        .content-option input[type="checkbox"] {
            margin-right: 10px;
            width: 18px;
            height: 18px;
            accent-color: var(--primary-color);
            cursor: pointer;
        }

        .list-items {
            margin-top: 15px;
        }

        .list-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            gap: 10px;
        }

        .list-item input {
            flex-grow: 1;
            padding: 10px 15px;
            background-color: var(--secondary-color);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            font-family: 'Poppins', sans-serif;
        }

        .sections-container {
            margin-top: 40px;
        }

        .section-controls {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
        }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-secondary);
            font-size: 1rem;
            background-color: rgba(255, 255, 255, 0.03);
            border-radius: 10px;
            border: 1px dashed var(--border-color);
            margin: 20px 0;
        }

        .empty-state svg {
            width: 40px;
            height: 40px;
            margin-bottom: 15px;
            color: var(--primary-color);
        }

        .drag-handle {
            cursor: move;
            color: var(--text-secondary);
            margin-right: 10px;
        }

        @media (max-width: 768px) {
            body {
                padding: 15px;
            }

            .form-container {
                padding: 20px;
            }

            .button-group {
                flex-direction: column;
            }

            button {
                width: 100%;
            }
        }

        /* Animações */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .section {
            animation: fadeIn 0.3s ease-out forwards;
        }

        /* Tooltip */
        .tooltip {
            position: relative;
            display: inline-block;
            margin-left: 5px;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: var(--secondary-color);
            color: var(--text-primary);
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.8rem;
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
    </style>
</head>

<body>
    <div class="logo">
        <i class="fas fa-graduation-cap"></i>
        Acadly
    </div>
    <h1>Gerador de Trabalhos Escolares</h1>

    <div class="form-container">
        <div class="form-group">
            <label for="escola">Nome da Instituição:</label>
            <input type="text" id="escola" placeholder="Ex: Escola Estadual Professor João Silva">
            <p class="input-hint">O nome completo da sua escola ou faculdade</p>
        </div>

        <div class="form-group">
            <label for="autor">Adicionar Autor:</label>
            <div class="author-container">
                <input type="text" id="autor" placeholder="Ex: Maria Oliveira Santos">
                <button type="button" class="btn-secondary" onclick="adicionarAutor()" style="margin-top: 10px;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                        viewBox="0 0 16 16">
                        <path
                            d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z" />
                    </svg>
                    Adicionar Autor
                </button>
                <p class="input-hint">Adicione todos os autores do trabalho</p>
            </div>
            <div class="authors-list" id="authors-list">
                <div class="empty-state" id="empty-authors">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                        <circle cx="8.5" cy="7" r="4"></circle>
                        <line x1="20" y1="8" x2="20" y2="14"></line>
                        <line x1="23" y1="11" x2="17" y2="11"></line>
                    </svg>
                    <p>Nenhum autor adicionado</p>
                </div>
            </div>
        </div>

        <div class="form-group">
            <label for="titulo">Título do Trabalho:</label>
            <input type="text" id="titulo" placeholder="Ex: A Importância da Reciclagem no Século XXI">
            <p class="input-hint">O título principal do seu trabalho</p>
        </div>

        <div class="form-group">
            <label for="subtitulo">Subtítulo (opcional):</label>
            <input type="text" id="subtitulo" placeholder="Ex: Um estudo de caso na cidade de São Paulo">
            <p class="input-hint">Subtítulo que aparecerá abaixo do título principal</p>
        </div>

        <h2 style="color: var(--primary-color); margin: 40px 0 20px; display: flex; align-items: center;">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                style="margin-right: 10px;">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
                <line x1="16" y1="13" x2="8" y2="13"></line>
                <line x1="16" y1="17" x2="8" y2="17"></line>
                <polyline points="10 9 9 9 8 9"></polyline>
            </svg>
            Seções do Trabalho
        </h2>

        <div class="sections-container" id="sections-container">
            <div class="empty-state" id="empty-sections">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="12" y1="8" x2="12" y2="12"></line>
                    <line x1="12" y1="16" x2="12.01" y2="16"></line>
                </svg>
                <p>Nenhuma seção adicionada</p>
                <p style="margin-top: 10px; font-size: 0.9rem;">Clique no botão abaixo para adicionar sua primeira seção
                </p>
            </div>
        </div>

        <button type="button" class="btn-secondary" onclick="adicionarSecao()" style="margin-top: 20px;">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                <path
                    d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z" />
            </svg>
            Adicionar Seção
        </button>

        <div class="button-group">
            <button class="btn-primary" onclick="gerarPDF()">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                    <path
                        d="M5.523 10.424q.21-.124.459-.238a8 8 0 0 1-.45.606c-.28.337-.498.516-.635.572l-.082.038a1 1 0 0 1-.146.05q-.327.11-.458-.09-.13-.2-.078-.44.026-.16.14-.36.114-.2.293-.37zm-1.79-.232q.225-.332.436-.549a7 7 0 0 1 1.122-.92l.075-.045a1 1 0 0 1 .2-.126q-.179-.242-.42-.438-.24-.196-.438-.27a7 7 0 0 0-1.12-.92l-.119-.07a1 1 0 0 0-.2-.127q.13.376.4.69.27.314.63.517z" />
                    <path
                        d="M14 4.5V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h5.5zm-3 0A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4.5z" />
                </svg>
                Gerar PDF
            </button>
            <button type="button" class="btn-warning" onclick="limparFormulario()">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                    <path
                        d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z" />
                    <path
                        d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z" />
                </svg>
                Limpar Tudo
            </button>
        </div>
    </div>

    <div class="footer">
        Parte do projeto <a href="https://github.com/codedgabriel/acadly" target="_blank">Acadly</a> - Gerador de
        trabalhos acadêmicos
    </div>

    <script>
        // Inicializa o jsPDF
        const { jsPDF } = window.jspdf;

        // Variáveis para armazenar dados
        let autores = [];
        let secoes = [];
        let imagensCarregadas = 0;
        let totalImagens = 0;

        // Adicionar autor à lista
        function adicionarAutor() {
            const autorInput = document.getElementById('autor');
            const autor = autorInput.value.trim();

            if (autor) {
                autores.push(autor);
                autorInput.value = '';
                atualizarListaAutores();

                // Feedback visual
                autorInput.focus();
                showToast('Autor adicionado com sucesso!', 'success');
            } else {
                showToast('Por favor, insira o nome do autor.', 'error');
            }
        }

        // Remover autor da lista
        function removerAutor(index) {
            autores.splice(index, 1);
            atualizarListaAutores();
            showToast('Autor removido.', 'warning');
        }

        // Atualizar lista de autores na UI
        function atualizarListaAutores() {
            const authorsList = document.getElementById('authors-list');
            const emptyState = document.getElementById('empty-authors');

            // Verifica se o emptyState existe antes de tentar removê-lo
            if (emptyState && emptyState.parentNode === authorsList) {
                authorsList.removeChild(emptyState);
            }

            // Se não há autores, recria o empty state
            if (autores.length === 0) {
                if (!document.getElementById('empty-authors')) {
                    const newEmptyState = document.createElement('div');
                    newEmptyState.className = 'empty-state';
                    newEmptyState.id = 'empty-authors';
                    newEmptyState.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                    <circle cx="8.5" cy="7" r="4"></circle>
                    <line x1="20" y1="8" x2="20" y2="14"></line>
                    <line x1="23" y1="11" x2="17" y2="11"></line>
                </svg>
                <p>Nenhum autor adicionado</p>
            `;
                    authorsList.appendChild(newEmptyState);
                }
                return;
            }

            authorsList.innerHTML = '';

            autores.forEach((autor, index) => {
                const authorItem = document.createElement('div');
                authorItem.className = 'author-item';
                authorItem.innerHTML = `
            <span class="author-name">${autor}</span>
            <button class="remove-author" onclick="removerAutor(${index})" title="Remover autor">
                <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" viewBox="0 0 16 16">
                    <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"/>
                    <path d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"/>
                </svg>
            </button>
        `;
                authorsList.appendChild(authorItem);
            });
        }

        // Adicionar nova seção
        function adicionarSecao() {
            const sectionId = Date.now();
            const sectionsContainer = document.getElementById('sections-container');
            const emptyState = document.getElementById('empty-sections');

            // Only try to remove empty state if it exists and is a child of sectionsContainer
            if (emptyState && emptyState.parentNode === sectionsContainer) {
                sectionsContainer.removeChild(emptyState);
            }

            const sectionHTML = `
        <div class="section" id="section-${sectionId}">
            <h3 class="section-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path>
                    <polyline points="13 2 13 9 20 9"></polyline>
                </svg>
                Nova Seção
            </h3>
            <button class="remove-btn btn-danger" onclick="removerSecao('${sectionId}')" title="Remover seção">
                <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" viewBox="0 0 16 16">
                    <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"/>
                    <path d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"/>
                </svg>
                Remover
            </button>
            
            <div class="section-content">
                <div class="form-group">
                    <label for="titulo-secao-${sectionId}">Título da Seção:</label>
                    <input type="text" id="titulo-secao-${sectionId}" placeholder="Ex: Introdução" class="section-title-input" required>
                    <p class="input-hint">Título que aparecerá no trabalho</p>
                </div>
                
                <div class="content-option">
                    <label>
                        <input type="checkbox" id="add-texto-${sectionId}" checked>
                        Adicionar Texto
                    </label>
                    <textarea id="texto-secao-${sectionId}" placeholder="Digite o conteúdo desta seção..." style="margin-top: 10px;"></textarea>
                    <p class="input-hint">Use parágrafos separados por linhas vazias para melhor formatação</p>
                </div>
                
                <div class="content-option">
                    <label>
                        <input type="checkbox" id="add-imagem-${sectionId}">
                        Adicionar Imagem
                    </label>
                    <div id="imagem-container-${sectionId}" style="display: none; margin-top: 10px;">
                        <input type="file" id="imagem-secao-${sectionId}" accept="image/*" style="margin-bottom: 10px;">
                        <img id="image-preview-${sectionId}" class="image-preview" alt="Pré-visualização da imagem">
                        <p class="input-hint">Formatos suportados: JPG, PNG (Tamanho máximo: 5MB)</p>
                    </div>
                </div>
                
                <div class="content-option">
                    <label>
                        <input type="checkbox" id="add-lista-${sectionId}">
                        Adicionar Lista
                    </label>
                    <div id="lista-container-${sectionId}" style="display: none; margin-top: 10px;">
                        <div class="list-items" id="lista-items-${sectionId}">
                            <!-- Itens da lista serão adicionados aqui -->
                        </div>
                        <button type="button" class="btn-secondary" onclick="adicionarItemLista('${sectionId}')" style="margin-top: 10px;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
                            </svg>
                            Adicionar Item
                        </button>
                        <p class="input-hint">Itens serão exibidos como lista com marcadores</p>
                    </div>
                </div>
            </div>
        </div>
    `;

            sectionsContainer.insertAdjacentHTML('beforeend', sectionHTML);

            // Configurar eventos para os checkboxes
            document.getElementById(`add-imagem-${sectionId}`).addEventListener('change', function () {
                document.getElementById(`imagem-container-${sectionId}`).style.display = this.checked ? 'block' : 'none';
            });

            document.getElementById(`add-lista-${sectionId}`).addEventListener('change', function () {
                document.getElementById(`lista-container-${sectionId}`).style.display = this.checked ? 'block' : 'none';
            });

            // Configurar preview de imagem
            document.getElementById(`imagem-secao-${sectionId}`).addEventListener('change', function (e) {
                const file = e.target.files[0];
                if (file) {
                    if (file.size > 5 * 1024 * 1024) {
                        showToast('A imagem deve ter no máximo 5MB', 'error');
                        this.value = '';
                        return;
                    }

                    const reader = new FileReader();
                    reader.onload = function (event) {
                        const preview = document.getElementById(`image-preview-${sectionId}`);
                        preview.src = event.target.result;
                        preview.style.display = 'block';
                    };
                    reader.readAsDataURL(file);
                }
            });

            // Adicionar primeiro item de lista
            adicionarItemLista(sectionId);

            // Rolagem suave para a nova seção
            setTimeout(() => {
                document.getElementById(`section-${sectionId}`).scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }, 100);

            showToast('Nova seção adicionada!', 'success');
        }

        // Remover seção
        function removerSecao(sectionId) {
            if (confirm('Tem certeza que deseja remover esta seção e todo o seu conteúdo?')) {
                const section = document.getElementById(`section-${sectionId}`);
                section.parentNode.removeChild(section);

                const sectionsContainer = document.getElementById('sections-container');
                if (sectionsContainer.children.length === 0) {
                    sectionsContainer.appendChild(document.getElementById('empty-sections'));
                }

                showToast('Seção removida.', 'warning');
            }
        }

        // Adicionar item à lista
        function adicionarItemLista(sectionId) {
            const itemId = Date.now();
            const listaItems = document.getElementById(`lista-items-${sectionId}`);

            const itemHTML = `
                <div class="list-item" id="item-${itemId}">
                    <input type="text" placeholder="Digite um item da lista">
                    <button type="button" class="btn-danger" onclick="removerItemLista('${itemId}')" title="Remover item">
                        <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"/>
                            <path d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"/>
                        </svg>
                    </button>
                </div>
            `;

            listaItems.insertAdjacentHTML('beforeend', itemHTML);

            // Focar no novo input
            setTimeout(() => {
                document.querySelector(`#item-${itemId} input`).focus();
            }, 50);
        }

        // Remover item da lista
        function removerItemLista(itemId) {
            const item = document.getElementById(`item-${itemId}`);
            if (item) {
                item.remove();
            }
        }

        // Limpar formulário
        function limparFormulario() {
            if (confirm('Tem certeza que deseja limpar todo o formulário? Todos os dados serão perdidos.')) {
                document.getElementById('escola').value = '';
                document.getElementById('autor').value = '';
                document.getElementById('titulo').value = '';
                document.getElementById('subtitulo').value = '';

                // Limpar seções
                const sectionsContainer = document.getElementById('sections-container');
                sectionsContainer.innerHTML = '';
                sectionsContainer.appendChild(document.getElementById('empty-sections'));

                // Limpar autores
                autores = [];
                atualizarListaAutores();

                showToast('Formulário limpo com sucesso.', 'success');
            }
        }

        // Mostrar toast notification
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            toast.textContent = message;
            document.body.appendChild(toast);

            setTimeout(() => {
                toast.classList.add('show');
            }, 10);

            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => {
                    toast.remove();
                }, 300);
            }, 3000);
        }

        // Gerar PDF com formatação ABNT
        function gerarPDF() {
            // Obter os valores dos campos
            const escola = document.getElementById('escola').value || 'Nome da Escola';
            const titulo = document.getElementById('titulo').value || 'Título do Trabalho';
            const subtitulo = document.getElementById('subtitulo').value;

            // Verificar se há autores
            if (autores.length === 0) {
                showToast('Por favor, adicione pelo menos um autor.', 'error');
                return;
            }

            // Obter todas as seções
            const sectionElements = document.querySelectorAll('.section');

            // Verificar se há seções
            if (sectionElements.length === 0) {
                showToast('Por favor, adicione pelo menos uma seção.', 'error');
                return;
            }

            // Verificar se todas as seções têm título
            let todasSecoesValidas = true;
            sectionElements.forEach(section => {
                const sectionId = section.id.split('-')[1];
                const tituloSecao = document.getElementById(`titulo-secao-${sectionId}`).value;
                if (!tituloSecao) {
                    todasSecoesValidas = false;
                    document.getElementById(`titulo-secao-${sectionId}`).focus();
                }
            });

            if (!todasSecoesValidas) {
                showToast('Por favor, preencha o título de todas as seções.', 'error');
                return;
            }

            // Coletar dados das seções
            const secoes = [];
            let totalImagens = 0;
            let imagensCarregadas = 0;

            // Contar imagens para processamento
            sectionElements.forEach(section => {
                const sectionId = section.id.split('-')[1];
                if (document.getElementById(`add-imagem-${sectionId}`).checked) {
                    const imagemInput = document.getElementById(`imagem-secao-${sectionId}`);
                    if (imagemInput.files.length > 0) {
                        totalImagens++;
                    }
                }
            });

            const promises = [];

            // Processar cada seção
            sectionElements.forEach((section, index) => {
                const sectionId = section.id.split('-')[1];
                const tituloSecao = document.getElementById(`titulo-secao-${sectionId}`).value;

                const secao = {
                    titulo: tituloSecao,
                    conteudo: [],
                    ordem: index
                };

                // Texto
                if (document.getElementById(`add-texto-${sectionId}`).checked) {
                    const texto = document.getElementById(`texto-secao-${sectionId}`).value;
                    if (texto) {
                        secao.conteudo.push({
                            tipo: 'texto',
                            valor: texto
                        });
                    }
                }

                // Lista
                if (document.getElementById(`add-lista-${sectionId}`).checked) {
                    const itens = [];
                    const listaItems = document.getElementById(`lista-items-${sectionId}`).querySelectorAll('.list-item input');
                    listaItems.forEach(item => {
                        if (item.value) {
                            itens.push(item.value);
                        }
                    });

                    if (itens.length > 0) {
                        secao.conteudo.push({
                            tipo: 'lista',
                            valor: itens
                        });
                    }
                }

                // Imagem
                if (document.getElementById(`add-imagem-${sectionId}`).checked) {
                    const imagemInput = document.getElementById(`imagem-secao-${sectionId}`);
                    if (imagemInput.files.length > 0) {
                        const promise = new Promise((resolve) => {
                            const reader = new FileReader();
                            reader.onload = function (event) {
                                secao.conteudo.push({
                                    tipo: 'imagem',
                                    valor: event.target.result,
                                    nome: imagemInput.files[0].name
                                });
                                imagensCarregadas++;
                                resolve();
                            };
                            reader.readAsDataURL(imagemInput.files[0]);
                        });
                        promises.push(promise);
                    }
                }

                secoes.push(secao);
            });

            showToast('Preparando documento...', 'info');

            function processarSecoesEPDF() {
                const pdf = new jsPDF({
                    orientation: 'portrait',
                    unit: 'mm',
                    format: 'a4'
                });

                const margin = {
                    left: 30,
                    right: 20,
                    top: 30,
                    bottom: 20
                };

                const pageWidth = 210 - margin.left - margin.right;
                let y = margin.top;

                // Capa
                pdf.setFont('helvetica', 'bold');
                pdf.setFontSize(16);
                const escolaLines = pdf.splitTextToSize(escola.toUpperCase(), pageWidth);
                escolaLines.forEach((line, index) => {
                    pdf.text(line, 105, y + (index * 7), { align: 'center' });
                });
                y += escolaLines.length * 7 + 15;

                pdf.setFontSize(18);
                const tituloLines = pdf.splitTextToSize(titulo.toUpperCase(), pageWidth);
                tituloLines.forEach((line, index) => {
                    pdf.text(line, 105, y + (index * 8), { align: 'center' });
                });
                y += tituloLines.length * 8 + 5;

                if (subtitulo) {
                    pdf.setFontSize(14);
                    pdf.setFont('helvetica', 'normal');
                    const subtituloLines = pdf.splitTextToSize(subtitulo, pageWidth);
                    subtituloLines.forEach((line, index) => {
                        pdf.text(line, 105, y + (index * 6), { align: 'center' });
                    });
                    y += subtituloLines.length * 6 + 10;
                }

                pdf.setFontSize(12);
                const autoresText = autores.length > 1 ? 'Autores:' : 'Autor:';
                pdf.text(autoresText, 105, y, { align: 'center' });
                y += 7;

                pdf.setFont('helvetica', 'normal');
                autores.forEach(autor => {
                    const autorLines = pdf.splitTextToSize(autor, pageWidth);
                    autorLines.forEach((line, index) => {
                        pdf.text(line, 105, y + (index * 6), { align: 'center' });
                    });
                    y += autorLines.length * 6;
                });

                const dataAtual = new Date().toLocaleDateString('pt-BR', {
                    day: '2-digit',
                    month: '2-digit',
                    year: 'numeric'
                });

                y = 250;
                pdf.text(dataAtual, 105, y, { align: 'center' });

                // Conteúdo
                pdf.addPage();
                y = margin.top;
                pdf.setFont('times', 'normal');
                pdf.setFontSize(12);

                // Título do trabalho
                pdf.setFontSize(14);
                pdf.setFont('times', 'bold');
                const tituloTrabalhoLines = pdf.splitTextToSize(titulo, pageWidth);
                tituloTrabalhoLines.forEach((line, index) => {
                    pdf.text(line, margin.left, y + (index * 7));
                });
                y += tituloTrabalhoLines.length * 7 + 5;

                if (subtitulo) {
                    pdf.setFontSize(12);
                    pdf.setFont('times', 'italic');
                    const subtituloTrabalhoLines = pdf.splitTextToSize(subtitulo, pageWidth);
                    subtituloTrabalhoLines.forEach((line, index) => {
                        pdf.text(line, margin.left, y + (index * 6));
                    });
                    y += subtituloTrabalhoLines.length * 6 + 10;
                }

                // Seções
                secoes.sort((a, b) => a.ordem - b.ordem).forEach(secao => {
                    if (y > 270) {
                        pdf.addPage();
                        y = margin.top;
                    }

                    // Título da seção
                    pdf.setFontSize(12);
                    pdf.setFont('times', 'bold');
                    const tituloSecaoLines = pdf.splitTextToSize(secao.titulo, pageWidth);
                    tituloSecaoLines.forEach((line, index) => {
                        pdf.text(line, margin.left, y + (index * 6));
                    });
                    y += tituloSecaoLines.length * 6 + 5;

                    // Conteúdo da seção
                    pdf.setFont('times', 'normal');

                    secao.conteudo.forEach(item => {
                        if (y > 270) {
                            pdf.addPage();
                            y = margin.top;
                        }

                        switch (item.tipo) {
                            case 'texto':
                                const paragrafos = item.valor.split('\n').filter(p => p.trim() !== '');
                                for (const paragrafo of paragrafos) {
                                    if (y > 270) {
                                        pdf.addPage();
                                        y = margin.top;
                                    }

                                    const lines = pdf.splitTextToSize(paragrafo, pageWidth);
                                    pdf.text('    ' + lines[0], margin.left, y);
                                    y += 6;

                                    for (let i = 1; i < lines.length; i++) {
                                        if (y > 270) {
                                            pdf.addPage();
                                            y = margin.top;
                                        }
                                        pdf.text(lines[i], margin.left, y);
                                        y += 6;
                                    }
                                    y += 4;
                                }
                                break;

                            case 'imagem':
                                try {
                                    const imgProps = pdf.getImageProperties(item.valor);
                                    const width = Math.min(pageWidth, imgProps.width * 0.2);
                                    const height = (imgProps.height * width) / imgProps.width;

                                    if (y + height > 270) {
                                        pdf.addPage();
                                        y = margin.top;
                                    }

                                    pdf.addImage(item.valor, 'JPEG', (210 - width) / 2, y, width, height);
                                    y += height + 10;

                                    // Legenda da imagem (opcional)
                                    pdf.setFontSize(10);
                                    pdf.text(`Figura: ${item.nome}`, 105, y, { align: 'center' });
                                    y += 6;
                                    pdf.setFontSize(12);
                                } catch (e) {
                                    console.error('Erro ao adicionar imagem:', e);
                                }
                                break;

                            case 'lista':
                                item.valor.forEach(itemLista => {
                                    if (y > 270) {
                                        pdf.addPage();
                                        y = margin.top;
                                    }

                                    const itemLines = pdf.splitTextToSize(`• ${itemLista}`, pageWidth - 10);
                                    itemLines.forEach((line, i) => {
                                        if (i === 0) {
                                            pdf.text(line, margin.left, y);
                                        } else {
                                            pdf.text(line, margin.left + 5, y);
                                        }
                                        y += 6;
                                    });
                                });
                                y += 5;
                                break;
                        }
                    });

                    y += 10;
                });

                // Número de páginas
                const totalPages = pdf.internal.getNumberOfPages();
                for (let i = 1; i <= totalPages; i++) {
                    pdf.setPage(i);
                    pdf.setFontSize(10);
                    pdf.text(`${i}`, 105, 287, { align: 'center' });
                }

                pdf.save(`trabalho-${titulo.toLowerCase().replace(/\s+/g, '-')}.pdf`);
                showToast('PDF gerado com sucesso!', 'success');
            }

            // Processar
            if (promises.length > 0) {
                Promise.all(promises).then(() => {
                    processarSecoesEPDF();
                }).catch(error => {
                    console.error('Erro ao carregar imagens:', error);
                    showToast('Erro ao processar imagens', 'error');
                });
            } else {
                processarSecoesEPDF();
            }
        }

        // Inicializar lista de autores e adicionar primeira seção
        atualizarListaAutores();

        // Adicionar estilos para toast
        const toastStyles = document.createElement('style');
        toastStyles.textContent = `
            .toast {
                position: fixed;
                bottom: 30px;
                left: 50%;
                transform: translateX(-50%);
                padding: 12px 24px;
                border-radius: 8px;
                color: white;
                font-weight: 500;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
                z-index: 1000;
                opacity: 0;
                transition: opacity 0.3s ease;
            }
            
            .toast.show {
                opacity: 1;
            }
            
            .toast-success {
                background-color: var(--success-color);
            }
            
            .toast-error {
                background-color: var(--danger-color);
            }
            
            .toast-warning {
                background-color: var(--warning-color);
            }
        `;
        document.head.appendChild(toastStyles);

        // Mostrar mensagem de boas-vindas
        setTimeout(() => {
            showToast('Bem-vindo ao Gerador de Trabalhos Acadly! Comece adicionando suas seções.', 'success');
        }, 1000);
    </script>
</body>

</html>